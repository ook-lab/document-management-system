# ベースイメージ：依存関係のみインストール
# requirements.txtが変わった時だけ再ビルドする
FROM python:3.12-slim

# システムツール（Tesseract, Popplerなど）をインストール
RUN apt-get update && apt-get install -y \
    tesseract-ocr \
    tesseract-ocr-jpn \
    libtesseract-dev \
    poppler-utils \
    libgl1 \
    && rm -rf /var/lib/apt/lists/*

WORKDIR /app

# 依存関係をインストール
COPY services/doc-processor/requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

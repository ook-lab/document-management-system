{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "育哉-学校 共通フォーム",
  "description": "学年通信、時間割、テスト通知など、全ての学校関連文書の共通構造。表データとテキストブロックを論理的に分離し、GPT/Claudeの構造化精度を高める。",
  "properties": {
    "issue_date": {
      "type": ["string", "null"],
      "format": "date",
      "title": "発行日",
      "description": "文書の発行日（YYYY-MM-DD形式）"
    },
    "relevant_date": {
      "type": ["string", "null"],
      "format": "date",
      "title": "関連日付",
      "description": "イベントやテストの実施日（YYYY-MM-DD形式）"
    },
    "grade": {
      "type": ["string", "null"],
      "title": "対象学年",
      "description": "文書の対象学年（例: 5年生）"
    },
    "event_type": {
      "type": ["string", "null"],
      "title": "文書の目的",
      "description": "timetable, test, notice, event など、文書の主な種類",
      "enum": ["timetable", "test", "notice", "event", "newsletter", "homework", "meeting", "other", null]
    },
    "things_to_bring": {
      "type": ["array", "null"],
      "title": "持ち物",
      "description": "イベントや授業で持参するもの",
      "items": {
        "type": "string"
      }
    },
    "schedule_details": {
      "type": ["string", "null"],
      "title": "スケジュール詳細",
      "description": "時間割やイベント日程の詳細（フリーテキスト）"
    },
    "key_topics": {
      "type": ["array", "null"],
      "title": "主要トピック",
      "description": "文書の主要な話題（健康、集金など）",
      "items": {
        "type": "string"
      }
    },
    "extracted_tables": {
      "type": ["array", "null"],
      "title": "抽出された表データ",
      "description": "pdfplumberまたはVisionで抽出された構造化データ（生データ）",
      "items": {
        "type": ["object", "null"]
      }
    },
    "weekly_schedule": {
      "type": ["array", "null"],
      "title": "週間予定・時間割",
      "description": "曜日・時限・クラスで構成される時間割表データ（表形式データの分離）",
      "items": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "title": "日付",
            "description": "MM-DD形式またはYYYY-MM-DD形式"
          },
          "day": {
            "type": "string",
            "title": "曜日",
            "description": "月、火、水など"
          },
          "day_of_week": {
            "type": "string",
            "title": "曜日（フル）",
            "description": "月曜日、火曜日など"
          },
          "events": {
            "type": "array",
            "title": "行事・イベント",
            "items": {
              "type": "string"
            }
          },
          "class_schedules": {
            "type": "array",
            "title": "クラス別時間割",
            "description": "各クラスの授業スケジュール（5A、5Bなどクラスごと）",
            "items": {
              "type": "object",
              "properties": {
                "class": {
                  "type": "string",
                  "title": "クラス名"
                },
                "subjects": {
                  "type": "array",
                  "title": "科目リスト",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "note": {
            "type": "string",
            "title": "備考・連絡事項"
          }
        }
      }
    },
    "monthly_schedule_blocks": {
      "type": ["array", "null"],
      "title": "月間予定表ブロック",
      "description": "学年便りの月間予定表から抽出した日付・イベント・備考のリスト",
      "items": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "title": "日付",
            "description": "MM-DD形式またはYYYY-MM-DD形式"
          },
          "day_of_week": {
            "type": ["string", "null"],
            "title": "曜日",
            "description": "月、火、水など"
          },
          "event": {
            "type": ["string", "null"],
            "title": "イベント・行事",
            "description": "その日の予定や行事の内容"
          },
          "time": {
            "type": ["string", "null"],
            "title": "時刻",
            "description": "集合時刻、下校時刻など（例: 7:45 集合、11:30 下校）"
          },
          "notes": {
            "type": ["string", "null"],
            "title": "備考",
            "description": "持ち物、場所などの補足情報"
          }
        },
        "required": ["date", "event"]
      }
    },
    "learning_content_blocks": {
      "type": ["array", "null"],
      "title": "教科別学習予定ブロック",
      "description": "学年便りの教科別学習予定から抽出した教科・内容・持ち物のリスト",
      "items": {
        "type": "object",
        "properties": {
          "subject": {
            "type": "string",
            "title": "教科名",
            "description": "国語、算数、理科、社会など"
          },
          "teacher": {
            "type": ["string", "null"],
            "title": "担当教員",
            "description": "その教科の担当教員名"
          },
          "content": {
            "type": "string",
            "title": "学習内容",
            "description": "その教科で学習する内容の詳細"
          },
          "materials": {
            "type": ["string", "null"],
            "title": "持ち物・準備物",
            "description": "その教科で必要な持ち物や教材"
          }
        },
        "required": ["subject", "content"]
      }
    },
    "structured_tables": {
      "type": ["array", "null"],
      "title": "その他の構造化表データ",
      "description": "weekly_schedule以外の汎用的な表データ（持ち物リスト、成績表、イベント一覧など）",
      "items": {
        "type": "object",
        "properties": {
          "table_title": {
            "type": "string",
            "title": "表のタイトル"
          },
          "table_type": {
            "type": "string",
            "title": "表の種類",
            "description": "requirements（持ち物）、events（行事）、scores（成績）など"
          },
          "headers": {
            "type": "array",
            "title": "列ヘッダー",
            "items": {
              "type": "string"
            }
          },
          "rows": {
            "type": "array",
            "title": "行データ",
            "items": {
              "type": "object"
            }
          }
        }
      }
    },
    "text_blocks": {
      "type": ["array", "null"],
      "title": "文章セクション（記事ブロック）",
      "description": "表以外の場所にある、まとまった文章セクション（朝会の話、振り返り、道徳の内容など）。テキストと表の論理的分離。",
      "items": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string",
            "title": "見出し",
            "description": "セクションのタイトル"
          },
          "content": {
            "type": "string",
            "title": "本文",
            "description": "セクションの本文（長文可、原文そのまま）"
          }
        },
        "required": ["title", "content"]
      }
    },
    "important_notes": {
      "type": ["array", "null"],
      "title": "連絡事項・重要事項",
      "description": "箇条書きの連絡事項や注意事項（原文そのまま）",
      "items": {
        "type": "string"
      }
    }
  },
  "required": []
}
